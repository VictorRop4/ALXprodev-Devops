#!/bin/bash

POKEMON_NAME=$1
OUTPUT_FILE="data.json"
ERROR_FILE="errors.txt"
MAX_RETRIES=3
RETRY_COUNT=0

# Function to make API request
fetch_pokemon_data() {
    curl -s -f "https://pokeapi.co/api/v2/pokemon/${POKEMON_NAME}" -o "$OUTPUT_FILE"
}

# Retry logic
while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
    if fetch_pokemon_data; then
        echo "Successfully fetched data for $POKEMON_NAME."
        exit 0
    else
        RETRY_COUNT=$((RETRY_COUNT + 1))
        echo "Attempt $RETRY_COUNT for $POKEMON_NAME failed. Retrying..."
        sleep 2  # Wait before retry
    fi
done

# If all retries failed, log the error
echo "Failed to fetch data for $POKEMON_NAME after $MAX_RETRIES attempts." >> "$ERROR_FILE"
exit 1

